### æ–¹æ³•ä¸€ï¼šåŒæŒ‡é’ˆ

æ ¹æ®é¢˜ç›®æè¿°ï¼Œç§»é™¤ä¸€ä¸ªå­æ•°ç»„åï¼Œå‰©ä½™å…ƒç´ ä¸¥æ ¼é€’å¢ï¼Œé‚£ä¹ˆå­˜åœ¨ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š

1. å‰©ä½™å…ƒç´ ä»…åŒ…å«æ•°ç»„ $nums$ çš„å‰ç¼€ï¼ˆå¯ä»¥ä¸ºç©ºï¼‰ï¼›
2. å‰©ä½™å…ƒç´ ä»…åŒ…å«æ•°ç»„ $nums$ çš„åç¼€ï¼›
3. å‰©ä½™å…ƒç´ åŒ…å«æ•°ç»„ $nums$ çš„å‰ç¼€å’Œåç¼€ã€‚

å…¶ä¸­ç¬¬ $2$ å’Œç¬¬ $3$ ç§æƒ…å†µå¯ä»¥åˆå¹¶ä¸ºä¸€ç§æƒ…å†µï¼Œå³å‰©ä½™å…ƒç´ åŒ…å«æ•°ç»„ $nums$ çš„åç¼€ã€‚å³ä¸€å…±æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š

1. å‰©ä½™å…ƒç´ ä»…åŒ…å«æ•°ç»„ $nums$ çš„å‰ç¼€ï¼ˆå¯ä»¥ä¸ºç©ºï¼‰ï¼›
2. å‰©ä½™å…ƒç´ åŒ…å«æ•°ç»„ $nums$ çš„åç¼€ã€‚

æˆ‘ä»¬å…ˆè€ƒè™‘ç¬¬ä¸€ç§æƒ…å†µï¼Œå³å‰©ä½™å…ƒç´ ä»…åŒ…å«æ•°ç»„ $nums$ çš„å‰ç¼€ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆ $i$ æŒ‡å‘æ•°ç»„ $nums$ çš„æœ€é•¿é€’å¢å‰ç¼€çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå³ $nums[0] \lt nums[1] \lt \cdots \lt nums[i]$ï¼Œé‚£ä¹ˆå‰©ä½™å…ƒç´ çš„ä¸ªæ•°ä¸º $n - i - 1$ï¼Œå…¶ä¸­ $n$ ä¸ºæ•°ç»„ $nums$ çš„é•¿åº¦ã€‚å› æ­¤ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œè¦ä½¿å¾—å‰©ä½™å…ƒç´ ä¸¥æ ¼é€’å¢ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç§»é™¤ä»¥ä¸‹å­æ•°ç»„ï¼š

1. $nums[i+1,...,n-1]$ï¼›
2. $nums[i,...,n-1]$ï¼›
3. $nums[i-1,...,n-1]$ï¼›
4. $nums[i-2,...,n-1]$ï¼›
5. $\cdots$ï¼›
6. $nums[0,...,n-1]$ã€‚

è¿™ä¸€å…±æœ‰ $i + 2$ ç§æƒ…å†µï¼Œå› æ­¤å¯¹äºè¿™ç§æƒ…å†µï¼Œç§»é™¤é€’å¢å­æ•°ç»„çš„æ•°ç›®ä¸º $i + 2$ã€‚

å†è€ƒè™‘ç¬¬äºŒç§æƒ…å†µï¼Œå³å‰©ä½™å…ƒç´ åŒ…å«æ•°ç»„ $nums$ çš„åç¼€ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆ $j$ æŒ‡å‘æ•°ç»„ $nums$ çš„é€’å¢åç¼€çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬åœ¨ $[n - 1,...,1]$ çš„èŒƒå›´å†…æšä¸¾ $j$ ä½œä¸ºé€’å¢åç¼€çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ¯ä¸€æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦ç§»åŠ¨æŒ‡é’ˆ $i$ ä½¿å¾— $nums[i] \lt nums[j]$ï¼Œé‚£ä¹ˆç§»é™¤é€’å¢å­æ•°ç»„çš„æ•°ç»„å¢åŠ  $i + 2$ã€‚å½“ $nums[j - 1] \ge nums[j]$ æ—¶ï¼Œæˆ‘ä»¬åœæ­¢æšä¸¾ï¼Œå› ä¸ºæ­¤æ—¶åç¼€ä¸æ˜¯ä¸¥æ ¼é€’å¢ã€‚

* [sol1-Python3]

```python
class Solution:
    def incremovableSubarrayCount(self, nums: List[int]) -> int:
        i, n = 0, len(nums)
        while i + 1 < n and nums[i] < nums[i + 1]:
            i += 1
        if i == n - 1:
            return n * (n + 1) // 2
        ans = i + 2
        j = n - 1
        while j:
            while i >= 0 and nums[i] >= nums[j]:
                i -= 1
            ans += i + 2
            if nums[j - 1] >= nums[j]:
                break
            j -= 1
        return ans
```

* [sol1-Java]

```java
class Solution {
    public int incremovableSubarrayCount(int[] nums) {
        int i = 0, n = nums.length;
        while (i + 1 < n && nums[i] < nums[i + 1]) {
            ++i;
        }
        if (i == n - 1) {
            return n * (n + 1) / 2;
        }
        int ans = i + 2;
        for (int j = n - 1; j > 0; --j) {
            while (i >= 0 && nums[i] >= nums[j]) {
                --i;
            }
            ans += i + 2;
            if (nums[j - 1] >= nums[j]) {
                break;
            }
        }
        return ans;
    }
}
```

* [sol1-C++]

```cpp
class Solution {
public:
    int incremovableSubarrayCount(vector<int>& nums) {
        int i = 0, n = nums.size();
        while (i + 1 < n && nums[i] < nums[i + 1]) {
            ++i;
        }
        if (i == n - 1) {
            return n * (n + 1) / 2;
        }
        int ans = i + 2;
        for (int j = n - 1; j > 0; --j) {
            while (i >= 0 && nums[i] >= nums[j]) {
                --i;
            }
            ans += i + 2;
            if (nums[j - 1] >= nums[j]) {
                break;
            }
        }
        return ans;
    }
};
```

* [sol1-Go]

```go
func incremovableSubarrayCount(nums []int) int {
	i, n := 0, len(nums)
	for i+1 < n && nums[i] < nums[i+1] {
		i++
	}
	if i == n-1 {
		return n * (n + 1) / 2
	}
	ans := i + 2
	for j := n - 1; j > 0; j-- {
		for i >= 0 && nums[i] >= nums[j] {
			i--
		}
		ans += i + 2
		if nums[j-1] >= nums[j] {
			break
		}
	}
	return ans
}
```

* [sol1-TypeScript]

```ts
function incremovableSubarrayCount(nums: number[]): number {
    const n = nums.length;
    let i = 0;
    while (i + 1 < n && nums[i] < nums[i + 1]) {
        i++;
    }
    if (i === n - 1) {
        return (n * (n + 1)) / 2;
    }
    let ans = i + 2;
    for (let j = n - 1; j; --j) {
        while (i >= 0 && nums[i] >= nums[j]) {
            --i;
        }
        ans += i + 2;
        if (nums[j - 1] >= nums[j]) {
            break;
        }
    }
    return ans;
}
```

æ—¶é—´å¤æ‚åº¦ $O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯æ•°ç»„ $nums$ çš„é•¿åº¦ã€‚ç©ºé—´å¤æ‚åº¦ $O(1)$ã€‚

---

æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºäº¤æµï¼Œæ¬¢è¿è¯„è®ºåŒºæä¾›å…¶å®ƒè§£é¢˜æ€è·¯ï¼ˆä»£ç ï¼‰ï¼Œä¹Ÿå¯ä»¥ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ä½œè€…å“ˆğŸ˜„~
